version: "3.1"
session_config:
  session_expiration_time: 60
  carry_over_slots_to_new_session: true
intents:
  - affirm
  - apertura
  - ask_nombre
  - cierre
  - comensales
  - cual_es_mi_nombre
  - deny
  - despedida
  - dia
  - establecer_menu
  - establecer_menu_plato
  - hora
  - horario
  - horario_concreto
  - identificar
  - identificar_borrar
  - menu_borra_todo
  - menu_borra_plato
  - menu_categoria
  - menu_completo
  - menu_plato_id
  - menu_usuario
  - opciones
  - repetir_nombre
  - reservar
  - reserva_borrar_mesa
  - saludo
  - stop
  - reserva_usuario
entities:
  - dia
  - first_name
  - first_name_save
  - menu_bebida_id
  - menu_bebida_nombre
  - menu_bebida_precio
  - menu_carne_id
  - menu_carne_nombre
  - menu_carne_precio
  - menu_entrante_id
  - menu_entrante_nombre
  - menu_entrante_precio
  - menu_establecido
  - menu_pescado_id
  - menu_pescado_nombre
  - menu_pescado_precio
  - menu_plato_categoria
  - menu_plato_id
  - menu_postre_id
  - menu_postre_nombre
  - menu_postre_precio
  - reserva_hora
  - reserva_comensales
  - reserva_dia
  - reserva_mesa_id
slots:
  dia:
    type: text
    influence_conversation: true
    mappings:
      - type: from_entity
        entity: dia
  first_name:
    type: text
    influence_conversation: true
    mappings:
      - type: from_text
        conditions:
          - active_loop: name_form
            requested_slot: first_name
  first_name_save:
    type: text
    influence_conversation: true
    mappings:
      - type: from_entity
        entity: first_name_save
        conditions:
          - active_loop: name_form
            requested_slot: first_name
  first_name_set:
    type: bool
    influence_conversation: true
    mappings:
      - type: custom
        conditions:
          - active_loop: name_form
            requested_slot: first_name
  menu_bebida_id:
    type: text
    influence_conversation: true
    mappings:
      - type: from_entity
        entity: menu_bebida_id
  menu_bebida_nombre:
    type: text
    influence_conversation: true
    mappings:
      - type: from_entity
        entity: menu_bebida_nombre
  menu_bebida_precio:
    type: text
    influence_conversation: true
    mappings:
      - type: from_entity
        entity: menu_bebida_precio
  menu_entrante_id:
    type: text
    influence_conversation: true
    mappings:
      - type: from_entity
        entity: menu_entrante_id
  menu_entrante_nombre:
    type: text
    influence_conversation: true
    mappings:
      - type: from_entity
        entity: menu_entrante_nombre
  menu_entrante_precio:
    type: text
    influence_conversation: true
    mappings:
      - type: from_entity
        entity: menu_entrante_precio
  menu_establecido:
    type: bool
    mappings:
      - type: from_entity
        entity: menu_establecido
  menu_carne_id:
    type: text
    influence_conversation: true
    mappings:
      - type: from_entity
        entity: menu_carne_id
  menu_carne_nombre:
    type: text
    influence_conversation: true
    mappings:
      - type: from_entity
        entity: menu_carne_nombre
  menu_carne_precio:
    type: text
    influence_conversation: true
    mappings:
      - type: from_entity
        entity: menu_carne_precio
  menu_pescado_id:
    type: text
    influence_conversation: true
    mappings:
      - type: from_entity
        entity: menu_pescado_id
  menu_pescado_nombre:
    type: text
    influence_conversation: true
    mappings:
      - type: from_entity
        entity: menu_pescado_nombre
  menu_pescado_precio:
    type: text
    influence_conversation: true
    mappings:
      - type: from_entity
        entity: menu_pescado_precio
  menu_plato_id:
    type: text
    influence_conversation: true
    mappings:
      - type: from_entity
        entity: menu_plato_id
  menu_plato_categoria:
    type: text
    influence_conversation: true
    mappings:
      - type: from_entity
        entity: menu_plato_categoria
  menu_postre_id:
    type: text
    influence_conversation: true
    mappings:
      - type: from_entity
        entity: menu_postre_id
  menu_postre_nombre:
    type: text
    influence_conversation: true
    mappings:
      - type: from_entity
        entity: menu_postre_nombre
  menu_postre_precio:
    type: text
    influence_conversation: true
    mappings:
      - type: from_entity
        entity: menu_postre_precio
  name_spelled_correctly:
    type: bool
    mappings:
      - type: from_intent
        intent: affirm
        value: true
        conditions:
          - active_loop: name_form
            requested_slot: first_name
      - type: from_intent
        intent: deny
        value: false
        conditions:
          - active_loop: name_form
            requested_slot: first_name
  reserva_comensales:
    type: text
    influence_conversation: true
    mappings:
      - type: from_text
        intent: comensales
        conditions:
          - active_loop: reserva_comensales_form
            requested_slot: reserva_comensales
  reserva_dia:
    type: text
    influence_conversation: true
    mappings:
      - type: from_text
        intent: dia
        conditions:
          - active_loop: reserva_dia_form
            requested_slot: reserva_dia
  reserva_hora:
    type: text
    influence_conversation: true
    mappings:
      - type: from_entity
        entity: reserva_hora
  reserva_mesa_id:
    type: text
    influence_conversation: true
    mappings:
      - type: from_entity
        entity: reserva_mesa_id
forms:
  menu_plato_id_form:
    required_slots:
      - menu_plato_id
  menu_plato_categoria_form:
    required_slots:
      - menu_plato_categoria
  name_form:
    required_slots:
      - first_name
  reserva_comensales_form:
    required_slots:
      - reserva_comensales
  reserva_dia_form:
    required_slots:
      - reserva_dia
  reserva_hora_form:
    required_slots:
      - reserva_hora
responses:
  utter_ask_name:
    - text: Introduce solo tu nombre, escribe "stop" para parar el formulario.
  utter_saludo:
    - text: Hola
  utter_saludo_identificacion:
    - condition:
        - type: slot
          name: first_name_set
          value: true
      text: Hola {first_name}!
    - text: ""
  utter_despedida:
    - text: Hasta otra.
  utter_horario:
    - text: "Nuestro horario es:"
  utter_menu:
    - text: ¿Quieres establecer el menu?
  utter_menu_aviso:
    - condition:
        - type: slot
          name: menu_establecido
          value: false
      text: "Aun falta por establecer el menu, si deseas establecerlo, escribe: Establecer menu."
    - text: ""
  utter_menu_plato_set:
    - text: "¿Quieres establecer el plato de la categoria: {menu_plato_categoria}?"
  utter_menu_categorias:
    - text: Estas son las categorias disponibles, selecciona una para ver los platos de dicha categoria.
  utter_menu_deny:
    - text: Cancelando proceso de establecer menu.
  utter_menu_borrar_deny:
    - text: Cancelado proceso de eliminar menu.
  utter_menu_borrar_plato:
    - condition:
        - type: slot
          name: menu_establecido
          value: true
      text: "¿Estas seguro de querer borrar el plato que seleccionaras a continuacion?"
    - text: ""
  utter_menu_borrar_plato_selecciona:
    - condition:
        - type: slot
          name: menu_establecido
          value: true
      text: "Introduce el identificador del plato a eliminar."
    - text: "Antes tienes que establecer un menu."
  utter_menu_borrar_todo:
    - condition:
        - type: slot
          name: menu_establecido
          value: true
      text: ¿Estas seguro de querer eliminar todo?
    - text: "Antes tienes que establecer un menu."
  utter_menu_plato_selecciona:
    - text: Selecciona el plato introduciendo el identificador.
  utter_opciones:
    - text: "Estas son las opciones de las que dispones:"
      buttons:
        - title: "Opciones"
          payload: "/opciones"
        - title: "Identificarme"
          payload: "/identificar"
        - title: "Horario"
          payload: "/horario"
        - title: "Apertura"
          payload: "/apertura"
        - title: "Cierre"
          payload: "/cierre"
        - title: "Establecer menu"
          payload: "/establecer_menu"
        - title: "Hacer reserva"
          payload: "/reservar"
        - title: "Borrar menu"
          payload: "/menu_borra_todo"
        - title: "Borrar plato"
          payload: "/menu_borra_plato"
        - title: "Consultar mi menu"
          payload: "/menu_usuario"
        - title: "Consultar mi reserva"
          payload: "/reserva_usuario"
  utter_reserva_borrar:
    - text: ¿Estas seguro de querer eliminar la reserva de la mesa?
  utter_reserva_borrar_deny:
    - text: "Proceso de borrado de reserva cancelado."
  utter_reserva_comensales:
    - text: ¿Quieres establecer los comensales?
  utter_reserva_comensales_especifica:
    - text: ¿Cuantos comensales sereis?
  utter_reserva_deny:
    - text: Cancelado proceso de reserva.
  utter_reserva_dia:
    - text: ¿Que dia quieres reservar?
  utter_reserva_hora:
    - text: ¿Quieres establecer la hora?
  utter_reserva_hora_especifica:
    - text: Dime la hora a la que quieres reservar, en formato "14:00"
  utter_te_llamas:
    - condition:
        - type: slot
          name: first_name_set
          value: true
      text: Te llamas {first_name}
    - text: Aun no me has dicho como te llamas, escribe "Identificarme" para establecer tu nombre.
  utter_ya_identificado:
    - condition:
        - type: slot
          name: first_name_set
          value: true
      text: Ya te has identificado.
    - text: ""
actions:
  - HorarioGet
  - IdentificarBorrarUsername
  - MenuBorrarPlato
  - MenuBorrarTodo
  - MenuGet
  - MenuGetCategoriasButtons
  - MenuGetUser
  - MenuResetPlatoID
  - ReservaBorrar
  - ReservaGetMesasLibres
  - ReservaGetUser
  - utter_ask_name
  - utter_despedida
  - utter_horario
  - utter_menu
  - utter_menu_aviso
  - utter_menu_borrar_deny
  - utter_menu_borrar_plato
  - utter_menu_categorias
  - utter_menu_deny
  - utter_menu_plato_selecciona
  - utter_menu_plato_set
  - utter_reserva_borrar
  - utter_reserva_borrar_deny
  - utter_reserva_comensales
  - utter_reserva_comensales_especifica
  - utter_reserva_deny
  - utter_reserva_dia
  - utter_reserva_hora
  - utter_reserva_hora_especifica
  - utter_saludo
  - utter_saludo_identificacion
  - utter_te_llamas
  - utter_ya_identificado
  - validate_menu_plato_categoria_form
  - validate_menu_plato_id_form
  - validate_name_form
  - validate_reserva_comensales_form
  - validate_reserva_dia_form
  - validate_reserva_hora_form
