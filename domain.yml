version: "3.1"
session_config:
  session_expiration_time: 60
  carry_over_slots_to_new_session: true
intents:
  - affirm
  - apertura
  - ask_nombre
  - borrar_bebida
  - borrar_carne
  - borrar_entrante
  - borrar_menu
  - borrar_pescado
  - borrar_plato
  - borrar_postre
  - cierre
  - cual_es_mi_nombre
  - deny
  - despedida
  - eliminar_reserva
  - establecer_menu
  - establecer_cantidad
  - establecer_plato_bebida
  - establecer_plato_bebida_id
  - establecer_plato_carne
  - establecer_plato_carne_id
  - establecer_plato_entrante
  - establecer_plato_entrante_id
  - establecer_plato_pescado
  - establecer_plato_pescado_id
  - establecer_plato_postre
  - establecer_plato_postre_id
  - hacer_reserva_comensales
  - horario
  - horario_concreto
  - identificar
  - menu
  - mi_menu
  - mostrar_cantidad_mesas_libres
  - mostrar_mesas_libres
  - mostrar_reserva_user
  - opciones
  - repetir_nombre
  - reservar_mesa
  - saludo
  - stop
entities:
  - bebida_id
  - bebida_nombre
  - bebida_precio
  - carne_id
  - carne_nombre
  - carne_precio
  - cantidad
  - categoria
  - comensales
  - dia
  - entrante_id
  - entrante_nombre
  - entrante_precio
  - first_name
  - first_name_save
  - mesa_disponible
  - mesa_reservada
  - pescado_id
  - pescado_nombre
  - pescado_precio
  - plato_establecido
  - postre_id
  - postre_nombre
  - postre_precio
slots:
  bebida_id:
    type: text
    influence_conversation: true
    mappings:
      - type: from_entity
        entity: bebida_id
  bebida_nombre:
    type: text
    influence_conversation: true
    mappings:
      - type: from_entity
        entity: bebida_nombre
  bebida_precio:
    type: text
    influence_conversation: true
    mappings:
      - type: from_entity
        entity: bebida_precio
  cantidad:
    type: text
    influence_conversation: true
    mappings:
      - type: from_entity
        entity: cantidad
        condition:
          - active_loop: cantidad_form
            requested_slot: cantidad
  carne_id:
    type: text
    influence_conversation: true
    mappings:
      - type: from_entity
        entity: carne_id
  carne_nombre:
    type: text
    influence_conversation: true
    mappings:
      - type: from_entity
        entity: carne_nombre
  carne_precio:
    type: text
    influence_conversation: true
    mappings:
      - type: from_entity
        entity: carne_precio
  categoria:
    type: text
    mappings:
      - type: from_entity
        entity: categoria
  comensales:
    type: text
    influence_conversation: true
    mappings:
      - type: from_entity
        entity: comensales
  dia:
    type: text
    influence_conversation: true
    mappings:
      - type: from_entity
        entity: dia
  entrante_id:
    type: text
    influence_conversation: true
    mappings:
      - type: from_entity
        entity: entrante_id
  entrante_nombre:
    type: text
    influence_conversation: true
    mappings:
      - type: from_entity
        entity: entrante_nombre
  entrante_precio:
    type: text
    influence_conversation: true
    mappings:
      - type: from_entity
        entity: entrante_precio
  first_name:
    type: text
    influence_conversation: true
    mappings:
      - type: from_text
        conditions:
          - active_loop: name_form
            requested_slot: first_name
  first_name_save:
    type: text
    influence_conversation: true
    mappings:
      - type: from_text
        conditions:
          - active_loop: name_form
            requested_slot: first_name
  first_name_set:
    type: bool
    influence_conversation: true
    mappings:
      - type: custom
        conditions:
          - active_loop: name_form
            requested_slot: first_name
  mesa_disponible:
    type: bool
    mappings:
      - type: from_entity
        entity: mesa_disponible
        value: true
  mesa_reservada:
    type: text
    mappings:
      - type: from_entity
        entity: mesa_reservada
  name_spelled_correctly:
    type: bool
    mappings:
      - type: from_intent
        intent: affirm
        value: true
        conditions:
          - active_loop: name_form
            requested_slot: first_name
      - type: from_intent
        intent: deny
        value: false
        conditions:
          - active_loop: name_form
            requested_slot: first_name
  pescado_id:
    type: text
    influence_conversation: true
    mappings:
      - type: from_entity
        entity: pescado_id
  pescado_nombre:
    type: text
    influence_conversation: true
    mappings:
      - type: from_entity
        entity: pescado_nombre
  pescado_precio:
    type: text
    influence_conversation: true
    mappings:
      - type: from_entity
        entity: pescado_precio
  plato_establecido:
    type: bool
    influence_conversation: true
    mappings:
      - type: from_entity
        entity: plato_establecido
        value: false
  postre_id:
    type: text
    influence_conversation: true
    mappings:
      - type: from_entity
        entity: postre_id
  postre_nombre:
    type: text
    influence_conversation: true
    mappings:
      - type: from_entity
        entity: postre_nombre
  postre_precio:
    type: text
    influence_conversation: true
    mappings:
      - type: from_entity
        entity: postre_precio
forms:
  bebida_form:
    required_slots:
      - bebida_id
  cantidad_form:
    required_slots:
      - cantidad
  carne_form:
    required_slots:
      - carne_id
  categoria_form:
    required_slots:
      - categoria
  entrante_form:
    required_slots:
      - entrante_id
  name_form:
    required_slots:
      - first_name
  pescado_form:
    required_slots:
      - pescado_id
  postre_form:
    required_slots:
      - postre_id
responses:
  utter_saludo:
    - text: Hola.
  utter_did_that_help:
    - text: ¿Ha ayudado?
  utter_despedida:
    - text: Hasta otra.
  utter_saludo_identificacion:
    - condition:
        - type: slot
          name: first_name_set
          value: true
      text: Hola {first_name}!
    - text: ""
  utter_te_llamas:
    - condition:
        - type: slot
          name: first_name_set
          value: true
      text: Te llamas {first_name}
    - text: Aun no me has dicho como te llamas, escribe "Identificarme" para establecer tu nombre.
  utter_ask_name:
    - text: Introduce solo tu nombre, escribe "stop" para parar el formulario.
  utter_opciones:
    - text: |
        Estas son las opciones de las que dispones:
        - Opciones
        - Identificarme
        - Horario
        - Apertura
        - Cierre
        - Establecer menu
        - Borrar menu
        - Borrar plato entrante
        - Borrar plato de carne
        - Borrar plato de pescado
        - Borrar postre
        - Borrar bebida
  utter_ya_identificado:
    - condition:
        - type: slot
          name: first_name_set
          value: true
      text: Ya te has identificado.
    - text: ""
  utter_horario:
    - text: "Nuestro horario es:"
  utter_show_menu:
    - text: |
        Estas son las categorias disponibles:
        - Entrantes
        - Carnes
        - Pescados
        - Postres
        - Bebidas
  utter_ask_categoria:
    - text: Dime la categoria que deseas establecer.
  utter_ask_plato_ids:
    - text: Dime el ID del plato que deseas.
  utter_entrante_seleccionado:
    - text: Se ha establecido el plato "{entrante_nombre}" como entrante, con un precio de "{entrante_precio}".
  utter_carne_seleccionado:
    - text: Se ha establecido el plato "{carne_nombre}" como carne, con un precio de "{carne_precio}".
  utter_pescado_seleccionado:
    - text: Se ha establecido el plato "{pescado_nombre}" como pescado, con un precio de "{pescado_precio}".
  utter_postre_seleccionado:
    - text: Se ha establecido el plato "{postre_nombre}" como postre, con un precio de "{postre_precio}".
  utter_bebida_seleccionado:
    - text: Se ha establecido el plato "{bebida_nombre}" como bebida, con un precio de "{bebida_precio}".
  utter_stop:
    - text: Parando.
  utter_restablecer:
    - text: ¿Estas seguro de que quieres borrar todo el menu establecido? (Si/No)
  utter_change_plato_info:
    - text: Si en cualquier momento deseas cambiar el plato establecido, vuelve a repetir el proceso.
  utter_ask_numero_comensales:
    - text: ¿Cuantos comensales sereis?
  utter_ask_reservar_mesa:
    - condition:
        - type: slot
          name: mesa_disponible
          value: False
      text: ""
    - text: ¿Quieres reservar mesa? (Si/No)
  utter_ask_reservar_mesa_general:
    - text: "Para reservar mesa introduce: <Reservar mesa para X comensales>, donde X es el numero de personas."
  utter_ask_remove_reserva:
    - text: "¿Estas seguro de querer eliminar la reserva?"
  utter_ask_borrar_plato:
    - condition:
        - type: slot
          name: plato_establecido
          value: True
      text: "¿Que plato quieres eliminar? Escribe <Borrar plato categoria>"
    - text: ""
actions:
  - GetHorario
  - GetMenu
  - GetMesasLibres
  - GetUserMenu
  - MostrarReserva
  - opciones
  - RemoveMesa
  - ReservarMesa
  - ResetMenu
  - utter_ask_categoria
  - utter_ask_borrar_plato
  - utter_ask_name
  - utter_ask_plato_ids
  - utter_ask_remove_reserva
  - utter_ask_reservar_mesa
  - utter_ask_reservar_mesa_general
  - utter_bebida_seleccionado
  - utter_carne_seleccionado
  - utter_change_plato_info
  - utter_despedida
  - utter_entrante_seleccionado
  - utter_opciones
  - utter_pescado_seleccionado
  - utter_postre_seleccionado
  - utter_restablecer
  - utter_saludo
  - utter_saludo_identificacion
  - utter_show_menu
  - utter_stop
  - utter_ya_identificado
  - validate_cantidad_form
  - validate_categoria_form
  - validate_name_form
  - ValidateComensales
