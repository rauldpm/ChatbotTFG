version: "3.1"

rules:
  # -------------------------------------

  - rule: Despedida
    steps:
      - intent: despedida
      - action: utter_despedida

  - rule: Opciones
    steps:
      - intent: opciones
      - action: utter_opciones

  - rule: Saludo
    steps:
      - intent: saludo
      - action: utter_saludo
      - action: utter_opciones

  # -------------------------------------

  - rule: El usuario pregunta por horario
    steps:
      - intent: horario
      - action: GetHorario
      - active_loop: GetHorario

  - rule: El usuario pregunta por la apertura de un dia concreto
    steps:
      - intent: horario_concreto
      - action: GetHorario
      - active_loop: GetHorario

  - rule: El usuario pregunta por apertura
    steps:
      - intent: apertura
      - action: GetHorario
      - active_loop: GetHorario

  - rule: El usuario pregunta por cierre
    steps:
      - intent: cierre
      - action: GetHorario
      - active_loop: GetHorario

  - rule: Submit horario
    condition:
      - active_loop: GetHorario
    steps:
      - action: GetHorario
      - active_loop: null

  # -------------------------------------

  - rule: El usuario pregunta quien es
    steps:
      - intent: cual_es_mi_nombre
      - action: utter_te_llamas

  - rule: Avisa al usuario de que ya esta identificado
    condition:
      - slot_was_set:
          - first_name_set: true
    steps:
      - intent: identificar
      - action: utter_ya_identificado

  - rule: Activa el formulario de identificacion
    condition:
      - slot_was_set:
          - first_name_set: null
    steps:
      - intent: identificar
      - action: utter_ask_name
      - action: name_form
      - active_loop: name_form

  - rule: Termina el formulario de ifentificacion
    condition:
      - active_loop: name_form
    steps:
      - action: name_form
      - active_loop: null
      - slot_was_set:
          - requested_slot: null
      - action: utter_saludo_identificacion

  # -------------------------------------

  - rule: Menu selecionado
    steps:
      - intent: mi_menu
      - action: GetUserMenu

  - rule: Mostrar menu completo
    steps:
      - intent: menu
      - action: GetMenu

  - rule: Borrar entrante
    steps:
      - intent: borrar_entrante
      - action: ResetMenu

  - rule: Borrar carne
    steps:
      - intent: borrar_carne
      - action: ResetMenu

  - rule: Borrar pescado
    steps:
      - intent: borrar_pescado
      - action: ResetMenu

  - rule: Borrar postre
    steps:
      - intent: borrar_postre
      - action: ResetMenu

  - rule: Borrar bebida
    steps:
      - intent: borrar_bebida
      - action: ResetMenu
